---
title: ""
emoji: "🐈ྀི"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: []
published: false
---

# Lambda の同時実行制御で防ぐ、アクセス集中時の障害対策

この記事は、「なんで、Lambdaでサーバー立ててるの？」と聞かれた私が返答として出した答えの記事です。
自分の仕事で使用している技術

### 1. はじめに
- 突発的なアクセス増加による障害の経験
- Lambda を選んだ理由

### 2. Lambda と EC2 の違い
- スケーリングの仕組みの比較
- コスト構造の違い
- 運用負荷の差

### 3. 実装した対策
- 同時実行数の制御設定
- SQS による非同期処理化
- モニタリングとアラート設定

### 4. 負荷テスト結果とまとめ
- テスト結果（改善前後の比較）
- 得られた知見と今後の課題

---

## EC2 との主な違い

| 観点 | Lambda | EC2 |
|------|--------|-----|
| **スケーリング速度** | 数秒〜数十秒で自動スケール | Auto Scaling で数分かかる |
| **初期準備** | コードをデプロイするだけ | OS、ミドルウェアの設定が必要 |
| **コスト** | 実行時間分のみ課金 | インスタンス起動中は常に課金 |
| **同時実行制限** | デフォルト 1,000（リージョン全体） | インスタンス数の上限まで |
| **コールドスタート** | 初回起動に遅延あり | 常時起動なら遅延なし |
| **運用負荷** | サーバー管理不要 | パッチ適用、監視など必要 |

**教育ポイント（セキュリティ面）：**

Lambda を使う際は以下に注意してください：

1. **IAM ロールの権限**
   - Lambda に必要最小限の権限のみ付与していますか？
   - `*` でのワイルドカード許可は避けていますか？

2. **環境変数の扱い**
   - API キーやパスワードを環境変数に平文で入れていませんか？
   - AWS Secrets Manager や SSM Parameter Store の暗号化を使っていますか？

3. **VPC 設定**
   - RDS などプライベートリソースにアクセスする場合、VPC 内に配置していますか？
   - パブリックインターネットへのアクセスが必要な場合、NAT Gateway 経由になっていますか？

